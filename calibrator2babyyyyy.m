% Auto-generated by stereoCalibrator app on 01-Jul-2025
%-------------------------------------------------------


% Define images to process
imageFileNames1 = {'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo001_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo002_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo003_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo004_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo005_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo006_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo007_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo008_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo009_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo010_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo011_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo012_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo013_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo014_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo015_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo016_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo017_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo018_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo019_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo020_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo021_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo022_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo023_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo024_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo025_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo026_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo027_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo028_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo029_left.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\left\stereo030_left.jpg',...
    };
imageFileNames2 = {'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo001_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo002_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo003_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo004_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo005_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo006_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo007_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo008_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo009_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo010_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo011_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo012_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo013_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo014_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo015_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo016_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo017_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo018_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo019_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo020_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo021_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo022_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo023_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo024_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo025_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo026_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo027_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo028_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo029_right.jpg',...
    'C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration\split_stereo_images\right\stereo030_right.jpg',...
    };

% Detect calibration pattern in images
detector = vision.calibration.stereo.CheckerboardDetector();
[imagePoints, imagesUsed] = detectPatternPoints(detector, imageFileNames1, imageFileNames2);

% Generate world coordinates for the planar patten keypoints
squareSize = 25;  % in units of 'millimeters'
worldPoints = generateWorldPoints(detector, 'SquareSize', squareSize);

% Read one of the images from the first stereo pair
I1 = imread(imageFileNames1{1});
[mrows, ncols, ~] = size(I1);

% Calibrate the camera
[stereoParams, pairsUsed, estimationErrors] = estimateCameraParameters(imagePoints, worldPoints, ...
    'EstimateSkew', false, 'EstimateTangentialDistortion', false, ...
    'NumRadialDistortionCoefficients', 2, 'WorldUnits', 'millimeters', ...
    'InitialIntrinsicMatrix', [], 'InitialRadialDistortion', [], ...
    'ImageSize', [mrows, ncols]);

% View reprojection errors
h1=figure; showReprojectionErrors(stereoParams);

% Visualize pattern locations
h2=figure; showExtrinsics(stereoParams, 'CameraCentric');

% Display parameter estimation errors
displayErrors(estimationErrors, stereoParams);

% You can use the calibration data to rectify stereo images.
I2 = imread(imageFileNames2{1});
[J1, J2, reprojectionMatrix] = rectifyStereoImages(I1, I2, stereoParams);

% See additional examples of how to use the calibration data.  At the prompt type:
%showdemo('StereoCalibrationAndSceneReconstructionExample')
% showdemo('DepthEstimationFromStereoVideoExample')

% Add this to your existing MATLAB code after the calibration section

% Display parameter estimation errors
displayErrors(estimationErrors, stereoParams);

% Manual rectified images display (compatible with all MATLAB versions)
I1 = imread(imageFileNames1{30});
I2 = imread(imageFileNames2{30});
[J1, J2, reprojectionMatrix] = rectifyStereoImages(I1, I2, stereoParams);

% Show rectified stereo images with alignment lines
h3 = figure;
imshowpair(J1, J2, 'montage');
title('Rectified Stereo Images with Alignment Lines');

% Add horizontal lines to verify alignment
hold on;
imageHeight = size(J1, 1);
imageWidth = size(J1, 2);

% Draw horizontal lines every 50 pixels
for y = 50:50:imageHeight-50
    % Line on left image
    line([1, imageWidth], [y, y], 'Color', 'red', 'LineWidth', 2);
    % Line on right image (offset by image width)
    line([imageWidth+1, 2*imageWidth], [y, y], 'Color', 'red', 'LineWidth', 2);
end
hold off;

% You can also manually rectify and display with custom visualization
I1 = imread(imageFileNames1{24});
I2 = imread(imageFileNames2{24});
[J1, J2, reprojectionMatrix] = rectifyStereoImages(I1, I2, stereoParams);

% Custom visualization with horizontal lines
h5 = figure;
imshowpair(J1, J2, 'montage');
title('Rectified Stereo Images with Alignment Lines');

% Add horizontal lines to verify alignment
hold on;
imageHeight = size(J1, 1);
imageWidth = size(J1, 2);

% Draw horizontal lines every 50 pixels
for y = 50:50:imageHeight-50
    % Line on left image
    line([1, imageWidth], [y, y], 'Color', 'red', 'LineWidth', 1);
    % Line on right image (offset by image width)
    line([imageWidth+1, 2*imageWidth], [y, y], 'Color', 'red', 'LineWidth', 1);
end
hold off;

stereoParamsStruct = toStruct(stereoParams);
save('stereoParamsStruct.mat', 'stereoParamsStruct');



%{    OUTPUT WHEN CHECKING CONTENTS IN python

C:\Users\sybanzon\Documents\schoolFiles\RESERARCH\calibration> & C:/Python312/python.exe c:/Users/sybanzon/Documents/schoolFiles/RESERARCH/calibration/claudecalib.py
Top-level keys in .mat file:
  stereoParamsStruct: <class 'numpy.ndarray'>

Fields in 'stereoParamsStruct':
[('CameraParameters1', 'O'), ('CameraParameters2', 'O'), ('RotationOfCamera2', 
'O'), ('TranslationOfCamera2', 'O'), ('Version', 'O'), ('RectificationParams', 
'O')]

%}
